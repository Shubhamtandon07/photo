from pathlib import Path
import re
from collections import Counter

log_path = Path(r"C:\Users\SHTANDO\OneDrive - Mercedes-Benz (corpdir.onmicrosoft.com)\DWT_MP_RM1 - Dokumente\Project Chatbot\Available data\Mails Rasmus\_exports\msg_to_docx_redacted_20260216_190750\errors.log")

text = log_path.read_text(encoding="utf-8", errors="ignore")

# capture lines like: ERROR: filename.msg -> Exception(...)
errs = re.findall(r"ERROR:\s+(.*?)\s+->\s+(.+)", text)

print("Total error entries:", len(errs))

# show unique failing files
files = [e[0] for e in errs]
uniq_files = sorted(set(files))
print("Unique failing files:", len(uniq_files))
print("\nFailing files:")
for f in uniq_files:
    print(" -", f)

# show top exception types/messages
exc_msgs = [e[1] for e in errs]
top = Counter(exc_msgs).most_common(15)

print("\nTop error messages:")
for msg, n in top:
    print(f"{n}x  {msg[:200]}")
